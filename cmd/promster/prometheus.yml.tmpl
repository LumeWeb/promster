global:
  scrape_interval: {{.ScrapeInterval}}
  scrape_timeout: {{.ScrapeTimeout}}
  evaluation_interval: {{.EvaluationInterval}}

rule_files:
  - /rules.yml

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
    {{ if .AdminPassword }}
    basic_auth:
      username: {{.AdminUsername}}
      password: {{.AdminPassword}}
    {{ end }}

  {{ range .ServiceGroups }}
  - job_name: '{{ .Name }}'
    scheme: {{$.Scheme}}
    tls_config:
      insecure_skip_verify: {{$.TlsInsecure}}
    static_configs:
      - targets: {{ .Targets }}
    {{ if .BasicAuth }}
    basic_auth:
      username: {{ .BasicAuth.Username }}
      password: {{ .BasicAuth.Password }}
    {{ end }}
    metrics_path: {{ .MetricsPath }}
  {{ end }}
